# WebPurifier Frontend

WebPurifier의 브라우저 확장 프로그램(Chrome MV3 기준)을 빌드하고 사용하는 방법을 정리했습니다. 백엔드 API와 연동해 웹페이지의 텍스트를 실시간으로 차단/표시하며, 사용자 피드백을 수집합니다.

## 요구 사항

- Node.js 18 이상 (권장: 최신 LTS)
- npm 9 이상
- WebPurifier 백엔드 서비스 실행 (동일 저장소의 `backend/` 참고)

## 설치

```bash
cd frontend
npm install
```

## 빌드 & 개발

- `npm run build`: TypeScript 프로젝트를 검사한 뒤 Vite를 사용해 `dist/` 폴더에 생산용 번들을 생성합니다.
- `npm run dev`: Vite 개발 서버를 실행합니다. 팝업/옵션 페이지 UI를 빠르게 확인할 때 `http://localhost:5173/popup.html`, `http://localhost:5173/options.html` 등으로 접근할 수 있습니다. (콘텐츠 스크립트는 브라우저에서만 동작합니다.)
- `npm run preview`: 빌드 결과물을 로컬에서 정적 서버로 확인합니다.

## Chrome 확장 프로그램 로드

1. `npm run build` 실행 후 `frontend/dist` 디렉터리가 생성되었는지 확인합니다.
2. Chrome 주소창에 `chrome://extensions` 입력 후 개발자 모드를 켭니다.
3. "압축해제된 확장 프로그램을 로드" 버튼을 눌러 `frontend/dist` 폴더를 선택합니다.
4. 코드 변경 후에는 다시 `npm run build`를 실행하고, 확장 프로그램 카드에서 "새로고침"을 클릭합니다.

## 기능 사용 방법

### 1. 인증 및 기본 설정

- 확장 팝업을 열어 회원가입 또는 로그인합니다. 성공하면 액세스 토큰이 저장되고 필터링 토글이 활성화됩니다.
- 팝업 하단의 토글 스위치로 필터링 기능을 즉시 켜고 끌 수 있습니다.
- 팝업에서 카테고리 목록을 새로고침하거나 신규 카테고리를 추가해 필터 기준을 관리합니다.
- API 서버 주소가 변경되면 확장 옵션 페이지(`chrome://extensions` → WebPurifier → "세부정보" → "확장 프로그램 옵션")에서 수정하십시오.

### 2. 자동 필터링 동작

- 필터링이 켜져 있고 토큰이 유효하면, 페이지의 한국어 텍스트 노드가 감지되는 즉시 불투명 처리(pending) 후 백엔드에 판별을 요청합니다.
- 응답 결과가 "차단"이면 해당 블록이 블러 처리되고, 허용이면 즉시 원래 상태로 복원됩니다.
- 뷰포트 근처에 있는 텍스트부터 우선 처리하도록 큐가 구성되어 가시 영역의 블러가 빠르게 결정됩니다.

### 3. 피드백 & 수동 신고

- 블러된 요소 우측 상단에 표시되는 패널에서 감지된 카테고리를 선택하고 "약화" 버튼으로 오탐 피드백을 보낼 수 있습니다.
- 마우스로 텍스트를 드래그해 선택하면 선택 영역 옆에 피드백 버튼이 나타납니다. 카테고리를 선택해 강화/약화 의견을 전달할 수 있으며, 선택한 부분이 실제로 블러된 문맥 내인지 확인한 뒤 전송됩니다.
- 피드백 성공/실패 메시지는 패널에 실시간으로 표시되며 잠시 후 자동으로 사라집니다.

## 추가 팁

- `frontend/public` 폴더에 포함된 매니페스트와 아이콘 파일도 버전에 따라 수정할 수 있습니다. 빌드 시 그대로 `dist/`로 복사됩니다.
- 브라우저 저장소(`chrome.storage.sync`)에 토큰과 필터 설정이 보존되므로, 문제 발생 시 팝업에서 로그아웃하거나 Chrome 동기화 데이터를 초기화해 리셋할 수 있습니다.

궁금한 점이나 개선 아이디어가 있다면 이슈나 PR로 공유해주세요.
